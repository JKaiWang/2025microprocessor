LIST    p=18f4520
        #include <pic18f4520.inc>
        CONFIG  OSC = INTIO67
        CONFIG  WDT = OFF

        ORG     0x00
	LFSR 0, 0x00
	
	MOVLW 0x01
	MOVWF POSTINC0
	MOVLW 0x03
	MOVWF POSTINC0
	MOVLW 0x07
	MOVWF POSTINC0
	MOVLW 0x02
	MOVWF POSTINC0
	MOVLW 0x09
	MOVWF POSTINC0
	MOVLW 0x08
	MOVWF POSTINC0
	MOVLW 0x04
	MOVWF POSTINC0
	MOVLW 0x06
	MOVWF INDF0
	MOVWF 0x10 ; pivot
	
	MOVLW 0x07
	MOVWF 0x11 ; loop_count
	
	LFSR 0, 0x000 ; j
	LFSR 1, 0x000 ; i
    loop:
	MOVF 0x10, W
	CPFSGT INDF0 ; arr[j] > pivot skip
	GOTO swap
	MOVF POSTINC0, W
	DECFSZ 0x11
	GOTO loop
    ok: 
	LFSR 0, 0x007
	MOVF INDF1, W
	XORWF INDF0, W ; W = (FSR1) ^ FSR0
	XORWF INDF0, F
	XORWF INDF0, W ;W = FSR1
	MOVWF INDF1
	GOTO done
    swap:
	MOVF INDF1, W
	XORWF INDF0, W ; W = (FSR1) ^ FSR0
	XORWF INDF0 , F
	XORWF POSTINC0, W ;W = FSR1
	MOVWF INDF1
	MOVF POSTINC1, W
	DECFSZ 0x11
	GOTO loop
	GOTO ok
    done:
    NOP
    end


